# [Project] AI Golf Coach: YOLOv8-Pose를 활용한 기하학적 스윙 분석 및 자세 교정 솔루션
#### 2023131051 수학과 이민규
---

## 1. 프로젝트 개요 (Project Overview)

### 1.1 연구 배경 및 동기 (Motivation)
본 프로젝트는 골프 스윙의 자기주도적 학습 시 발생하는 객관적 피드백의 부재를 해결하기 위해 기획되었다. 실력 향상을 위해서는 자신의 스윙을 정밀하게 분석하는 과정이 필수적이나, 고가의 레슨이나 전문 장비 없이는 주관적인 판단에 의존할 수밖에 없는 한계가 존재한다. 이에 본 연구자는 수학적 근거를 바탕으로 스윙의 문제점을 정량적으로 진단하고 교정안을 제시하는 AI 기반 분석 시스템을 구현하였다.

### 1.2 개발 과정 및 모델 선정 (Development Journey)
초기 단계에서는 구현이 용이한 MediaPipe 라이브러리를 검토하였으나, 고속으로 이루어지는 골프 스윙의 관절 궤적을 더욱 정밀하게 추적하고 분석의 신뢰도를 높이기 위해 최신 SOTA(State-of-the-Art) 모델인 **YOLOv8-Pose**를 최종 채택하였다. 단순히 모델의 추론 결과를 출력하는 것을 넘어, 추출된 키포인트 데이터를 벡터 연산 및 기하학적 알고리즘과 결합하여 '치킨윙', '스웨이' 등 주요 오류를 논리적으로 판별하는 진단 엔진을 구축하는 데 집중하였다.

---

## 2. 기술 스택 (Tech Stack)

* **Language:** Python 3.12
* **Deep Learning:** Ultralytics YOLOv8-Pose, PyTorch
* **Computer Vision & Processing:** OpenCV, NumPy
* **Environment:** Google Colab (GPU Acceleration)

---

## 3. 수학적 모델링 및 분석 로직 (Mathematical Modeling & Logic)

본 프로그램은 추출된 관절 좌표를 기반으로 총 4단계의 수치 해석 과정을 거쳐 최종 피드백을 산출하도록 설계되었다.

### 3.1 좌표계 정의 및 데이터 정규화 (Normalization)
YOLOv8-Pose로부터 얻은 2차원 관절 좌표 데이터는 카메라와의 거리 및 해상도에 따라 값이 변동되므로, 어드레스 시점의 양쪽 어깨 거리($W_{shoulder}$)를 기준 단위($1.0$)로 설정하는 **Scale-Invariant Normalization**을 수행한다.
* **코드 적용:** `get_distance` 함수를 통해 어깨 너비를 산출하고, 모든 변위 데이터를 해당 값으로 나누어 상대적 비율로 변환함으로써 개인별 체형 및 촬영 환경에 따른 오차를 극복함.

### 3.2 시계열 데이터를 활용한 스윙 단계 분류 (Phase Segmentation)
손목의 평균 $y$좌표를 시간 $t$에 대한 함수 $H(t)$로 정의하고, 이 함수의 임계점(Critical Point)을 분석하여 스윙 단계를 구분한다.
* **Backswing Top:** $H(t)$가 전역 극소값(Global Minimum, 화면 상단)을 가지며, 손목이 어깨보다 높은 위치($y_{wrist} < y_{shoulder}$)에 도달하는 시점.
* **Impact:** 다운스윙 이후 $H(t)$가 국소 극대값(Local Maximum)을 가지는 시점으로, 클럽 헤드가 지면에 가장 근접하는 순간.

### 3.3 기하학적 특징 추출 (Geometric Feature Extraction)
신체 주요 관절의 사잇각을 산출하기 위해 두 벡터의 내적을 이용한다. 어깨($P_s$), 팔꿈치($P_e$), 손목($P_w$) 좌표를 정점으로 하는 두 벡터 $\vec{u} = P_s - P_e$, $\vec{v} = P_w - P_e$ 사이의 각도 $\theta$는 다음과 같이 도출된다.

$$\theta = \cos^{-1} \left( \frac{\vec{u} \cdot \vec{v}}{\|\vec{u}\| \|\vec{v}\|} \right) \cdot \frac{180}{\pi}$$

* **코드 적용:** `calculate_angle` 함수 내에서 `np.arctan2` 연산을 통해 매 프레임 관절각을 실시간으로 산출하여 분석 결과에 반영함.

---

## 4. 단계별 진단 메커니즘 및 시스템 피드백 (Diagnosis & System Feedback)

본 절에서는 각 스윙 단계에서 발생하는 물리적 오류의 판별 기준과 프로그램이 실제로 제시하는 피드백 메시지를 기술한다.

### 4.1 Address: 스탠스 안정성 분석
* **판별 로직:** 양발 사이의 거리($D_{feet}$)와 어깨 너비($W_{shoulder}$)를 비교.
* **오류 판정:** $D_{feet} > 1.5 \times W_{shoulder}$ 일 경우 과도한 스탠스로 판정.
* **역학적 해석:** 과도하게 넓은 스탠스는 골반 회전의 가동 범위를 제한하여 에너지 전달 효율을 저하시킴.
* **시스템 출력:** * `⚠️ [문제점] 스탠스가 너무 넓습니다. 회전이 제한될 수 있습니다.`
  * `💡 [해결책] 발을 어깨 너비 정도로 좁혀보세요.`

### 4.2 Backswing: 축 고정 및 확장성 진단
* **판별 로직 (Sway):** 어드레스 시 코 좌표($x_{nose,0}$)와 백스윙 탑 시의 좌표($x_{nose,top}$) 차이 분석.
* **오류 판정:** 변위 $\Delta x > 0.2 \times W_{shoulder}$ 인 경우 스웨이(Sway)로 판정.
* **시스템 출력:** `⚠️ [문제점] 머리가 타켓 반대 방향으로 너무 많이 이동했습니다. 💡 [해결책] 머리를 고정한 채 제자리에서 회전하세요.`
* **판별 로직 (Arm Extension):** 백스윙 탑에서 왼팔의 내각($\theta_{left\_arm}$) 측정.
* **오류 판정:** $\theta_{left\_arm} < 150^\circ$ 인 경우 아크(Arc) 축소로 간주.
* **시스템 출력:** `⚠️ [문제점] 탑에서 왼팔이 구부러졌습니다. 💡 [해결책] 왼팔을 타겟 반대 방향으로 멀리 밀어내며 쭉 펴주세요.`

### 4.3 Impact: 머리 위치 유지 (Head Behind the Ball)
* **판별 로직:** 임팩트 순간 코의 $x$좌표가 초기 기준선 대비 타겟 방향으로 전이되었는지 확인.
* **오류 판정:** $x_{nose, impact} < x_{nose, 0} - \epsilon$ 일 경우 상체 덤빔 현상으로 판정.
* **역학적 해석:** 머리가 공보다 앞서 나갈 경우 가파른 입사각(Steep Attack Angle)으로 인해 타격의 정확도와 거리가 손실됨.
* **시스템 출력:** * `⚠️ [문제점] 머리가 타겟 방향으로 덤벼들었습니다.`
  * `💡 [해결책] 공 뒤에서 친다는 느낌으로 머리를 오른발 쪽에 남겨두세요.`

### 4.4 Follow-through: 치킨윙(Chicken Wing) 감지
* **판별 로직:** 임팩트 직후 팔로스루 단계에서 왼팔의 내각($\theta_{left\_arm}$) 측정.
* **오류 판정:** $\theta_{left\_arm} < 140^\circ$ 인 경우 치킨윙 현상으로 판정.
* **역학적 해석:** 임팩트 후 팔이 당겨지는 현상은 릴리스(Release)를 방해하여 슬라이스를 유발하고 궤적의 일관성을 해침.
* **시스템 출력:** * `⚠️ [문제점] 임팩트 후 왼팔이 당겨지며 구부러지는 치킨윙 현상이 있습니다.`
  * `💡 [해결책] 왼손등이 타겟을 보며 낮고 길게 뻗어나가는 연습을 하세요.`

---


## 5. 실행 결과 및 분석 사례 (Results & Case Study)

본 장에서는 세계적인 프로 골퍼 로리 매킬로이(Rory McIlroy)의 드라이버 스윙 영상을 테스트 데이터로 사용하여 시스템의 판별 성능을 검증하였다.

### 5.1 테스트 환경 및 입력 데이터
* **Input Video:** Rory McIlroy Driver Swing (Front View)
  

https://github.com/user-attachments/assets/af913533-9c0b-4b65-9420-306f9cae8cb6


* **Model:** YOLOv8-Pose (Nano)

### 5.2 분석 결과 시각화
[Image 1: 시스템이 최종적으로 출력한 분석 보고서 이미지]
> **Figure 2.** 시스템 알고리즘에 의해 생성된 단계별 진단 리포트 (사용자 업로드 이미지 참조)
> <img width="710" height="401" alt="image" src="https://github.com/user-attachments/assets/bcd72ec2-2976-4f84-bd84-4dd62d335918" />

### 5.3 데이터 해석 및 고찰
분석 리포트 결과에 따르면, 프로 선수의 스윙임에도 불구하고 특정 단계에서 주의 메시지가 식별되었다. 이는 시스템이 설정한 수학적 임계값과 프로의 역학적 특성 차이에서 기인한다.
* **스탠스 분석:** 드라이버 샷의 지면 반발력을 극대화하기 위해 일반적인 기준보다 넓은 스탠스를 취하는 프로의 메커니즘이 시스템의 임계값($1.5 \times W_{shoulder}$)에 의해 엄격하게 판별됨을 확인하였다.
* **스웨이 분석:** 로리 매킬로이 특유의 역동적인 체중 이동 과정에서 발생하는 코(Nose) 좌표의 수평 이동을 시스템이 민감하게 포착하여 피드백을 생성하였다.
* **임팩트 및 팔로스루:** 임팩트 시 머리 위치 유지 및 팔로스루 시의 확장성이 본 알고리즘의 기하학적 기준을 완벽히 충족하며 '문제 없음'으로 산출되었다.

---

## 6. 연구의 한계점 (Limitations)

### 6.1 2D 투영에 따른 정보 손실 (Perspective Error)
단일 카메라 영상을 기반으로 하므로, 카메라의 촬영 각도나 골퍼의 정렬 상태에 따라 실제 3차원 공간에서의 관절 각도와 영상 데이터 간의 기하학적 오차가 발생할 수 있다.

### 6.2 해부학적 특성의 미반영 (Lack of Individuality)
현재 진단 임계값은 표준 스윙 모델을 기준으로 설정되어 있어, 개개인의 유연성, 신장 등 신체적 특성에 따른 최적화된 개별 스윙 궤적을 완벽히 반영하지 못하는 한계가 있다.

### 6.3 프레임 레이트 의존성 (Temporal Dependency)
고속 다운스윙 시 일반적인 30/60 FPS 영상으로는 임팩트의 정확한 찰나를 포착하는 데 시간 해상도의 한계가 존재할 수 있다.

---

## 7. 기대 효과 및 발전 방향 (Future Directions)

* **정량적 분석:** 주관적 느낌을 배제하고 각도와 변위라는 수치적 근거를 통해 객관적인 교정 지표를 제공함.
* **발전 방향:** 향후 **Cosine Similarity** 알고리즘을 도입하여 프로 선수와의 스윙 일치도를 점수화하거나, **LSTM** 모델을 통해 스윙 템포를 시계열적으로 분석하여 고도화할 예정임.

---

## 8. 마치며 (Conclusion)
본 프로젝트는 수학적 기하학 모델이 컴퓨터 비전 기술과 결합하여 실생활의 문제를 해결하는 공학적 프로세스를 탐구하는 데 의의가 있다. 데이터 정규화부터 물리적 임계값 설정을 통한 오류 진단까지 전 과정을 직접 설계하며 디지털 트랜스포메이션 시대의 스포츠 과학 분야에서의 IT 기술 활용 가능성을 확인하였다.
